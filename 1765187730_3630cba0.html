<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>合同对比</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            margin: 20px;
            background-color: #f8f9fa;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        .legend-container {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            border-left: 5px solid #3498db;
        }
        .legend-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        .legend-item {
            display: inline-block;
            margin-right: 20px;
            font-size: 14px;
        }
        .color-box {
            display: inline-block;
            width: 16px;
            height: 16px;
            margin-right: 5px;
            vertical-align: text-bottom;
            border-radius: 3px;
        }
        .addition {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
        }
        .deletion {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            text-decoration: line-through;
        }
        .modification {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
        }
        .comparison-container {
            display: flex;
            gap: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .contract-column {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            height: calc(100vh - 200px);
            border-right: 1px solid #eee;
        }
        .contract-column:last-child {
            border-right: none;
        }
        .contract-title {
            font-size: 20px;
            color: #2c3e50;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            margin-bottom: 20px;
            text-align: center;
        }
        .clause {
            margin-bottom: 25px;
            line-height: 1.6;
        }
        .clause-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 16px;
            border-left: 4px solid #3498db;
            padding-left: 10px;
        }
        .clause-content {
            color: #34495e;
            font-size: 14.5px;
            text-align: justify;
            padding-left: 14px;
        }
        .synchronized {
            scroll-behavior: smooth;
        }
        /* 滚动条样式 */
        .contract-column::-webkit-scrollbar {
            width: 8px;
        }
        .contract-column::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .contract-column::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>合同对比</h1>
    
    <div class="legend-container">
        <div class="legend-title">差异图例说明</div>
        <div class="legend-item">
            <span class="color-box addition"></span>新增内容
        </div>
        <div class="legend-item">
            <span class="color-box deletion"></span>删除内容
        </div>
        <div class="legend-item">
            <span class="color-box modification"></span>修改内容
        </div>
    </div>
    
    <div class="comparison-container">
        <div id="contractA" class="contract-column synchronized">
            <div class="contract-title">合同A</div>
            <!-- 合同A内容将通过JavaScript动态插入 -->
        </div>
        <div id="contractB" class="contract-column synchronized">
            <div class="contract-title">合同B</div>
            <!-- 合同B内容将通过JavaScript动态插入 -->
        </div>
    </div>

    <script>
        const contractA = "合同编号：2023-NCP-001
甲方（卖方）：王五
乙方（买方）：赵六
根据《中华人民共和国民法典》及相关规定，双方在平等自愿基础上，就农副产品买卖达成协议：
第一条 产品名称、数量、价格
1.1 产品名称：新疆苹果
1.2 数量：1500公斤
1.3 单价：每公斤12.5元，总金额18750元。
第二条 交货时间、地点
2.1 交货时间：2023年11月15日
2.2 交货地点：乙方指定物流集散中心
第三条 运输方式及费用
3.1 运输方式：冷链专车配送
3.2 费用承担：甲方预付运费，乙方收货后按实际结算返还
3.3 保险：货物运输保险由甲方购买，费用包含在运费中
第四条 验收标准
4.1 验收标准：GB/T 22345-2021鲜果等级标准
第五条 付款方式
5.1 合同签订后，乙方支付预付款5600元
5.2 余款13150元于交货后15个工作日内结清
第六条 违约责任
6.1 甲方延迟交货，每日赔付总金额0.9%
6.2 乙方延迟付款，每日赔付滞纳金0.8%
第七条 争议解决
7.1 争议由签约地（杭州市）仲裁委员会裁决
第八条 其他条款
8.1 本合同含附件《质检承诺书》
8.2 本合同经电子签章后生效，一式三份
甲方（电子签章）：_________
乙方（电子签章）：_________
签约日期：2023年10月18日";
        
        const contractB = "合同编号：2023-NCP-001
甲方（卖方）：王五
乙方（买方）：赵六
根据《中华人民共和国民法典》及相关规定，双方在平等自愿基础上，就农副产品买卖达成协议：
第一条 产品名称、数量、价格
1.1 产品名称：新疆香梨
1.2 数量：1500公斤
1.3 单价：每公斤12.5元，总金额18750元。
第二条 交货时间、地点
2.1 交货时间：2023年11月15日
2.2 交货地点：乙方指定物流集散中心
第三条 运输方式及费用
3.1 运输方式：冷链专车配送
3.2 费用承担：甲方预付运费，乙方收货后按实际结算返还
第四条 验收标准
4.1 验收标准：GB/T 22345-2021鲜果等级标准
4.2 抽样比例：每批次随机抽检8%
第五条 付款方式
5.1 合同签订后，乙方支付预付款5600元
5.2 余款13150元于交货后15个工作日内结清
第六条 违约责任
6.1 甲方延迟交货，每日赔付总金额0.8%
6.2 乙方延迟付款，每日赔付滞纳金0.7%
第七条 争议解决
7.1 争议由签约地（杭州市）仲裁委员会裁决
第八条 其他条款
8.1 本合同含附件《质检承诺书》
8.2 本合同经电子签章后生效，一式三份
甲方（电子签章）：_________
乙方（电子签章）：_________
签约日期：2023年10月18日";

        function markDifferences(textA, textB) {
            const linesA = textA.split('
');
            const linesB = textB.split('
');
            const maxLines = Math.max(linesA.length, linesB.length);
            let markedA = '';
            let markedB = '';

            for (let i = 0; i < maxLines; i++) {
                const lineA = linesA[i] || '';
                const lineB = linesB[i] || '';

                if (lineA.trim() === lineB.trim()) {
                    markedA += lineA + '
';
                    markedB += lineB + '
';
                } else if (lineA.trim() === '' && lineB.trim() !== '') {
                    markedA += '
';
                    markedB += `<span class="addition">${lineB}</span>
`;
                } else if (lineA.trim() !== '' && lineB.trim() === '') {
                    markedA += `<span class="deletion">${lineA}</span>
`;
                    markedB += '
';
                } else {
                    markedA += `<span class="modification">${lineA}</span>
`;
                    markedB += `<span class="modification">${lineB}</span>
`;
                }
            }
            return { markedA, markedB };
        }

        function parseContract(text, isA) {
            const lines = text.split('
');
            let html = '';
            let currentTitle = '';
            let currentContent = '';

            for (const line of lines) {
                if (line.trim().endsWith('：')) {
                    if (currentTitle) {
                        html += `
                        <div class="clause">
                            <div class="clause-title">${currentTitle}</div>
                            <div class="clause-content">${currentContent}</div>
                        </div>`;
                    }
                    currentTitle = line.trim();
                    currentContent = '';
                } else if (currentTitle) {
                    currentContent += (currentContent ? '<br>' : '') + line;
                }
            }
            if (currentTitle) {
                html += `
                <div class="clause">
                    <div class="clause-title">${currentTitle}</div>
                    <div class="clause-content">${currentContent}</div>
                </div>`;
            }
            return html;
        }

        function initComparison() {
            const { markedA, markedB } = markDifferences(contractA, contractB);
            
            const contractAHtml = parseContract(markedA, true);
            const contractBHtml = parseContract(markedB, false);
            
            document.getElementById('contractA').innerHTML = '<div class="contract-title">合同A</div>' + contractAHtml;
            document.getElementById('contractB').innerHTML = '<div class="contract-title">合同B</div>' + contractBHtml;
        }

        function setupSyncScroll() {
            const columns = document.querySelectorAll('.synchronized');
            let isSyncing = false;

            columns.forEach(col => {
                col.addEventListener('scroll', function() {
                    if (isSyncing) return;
                    isSyncing = true;
                    
                    const scrollTop = this.scrollTop;
                    const scrollHeight = this.scrollHeight;
                    const clientHeight = this.clientHeight;
                    
                    columns.forEach(otherCol => {
                        if (otherCol !== this) {
                            const ratio = scrollTop / (scrollHeight - clientHeight);
                            otherCol.scrollTop = ratio * (otherCol.scrollHeight - otherCol.clientHeight);
                        }
                    });
                    
                    setTimeout(() => isSyncing = false, 10);
                });
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            initComparison();
            setupSyncScroll();
        });
    </script>
</body>
</html>